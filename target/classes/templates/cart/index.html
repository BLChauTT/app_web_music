<html xmlns:th="http://www.thymeleaf.org">

<head>
	<title>Cart</title>
</head>

<body>

	<a th:href="@{'/product/index'}">Continue Shopping</a>
	<h3>Cart</h3>
	<form method="post" th:action="@{/cart/update}">
		<table border="1">
			<tr>
				<th>Action</th>
				<th>Id</th>
				<th>Name</th>
				<th>Photo</th>
				<th>Price</th>
				<th>
					Quantity
					<th:block th:if="${session.cart != null && session.cart.size() > 0}">
						<button type="submit">Update</button>
					</th:block>
				</th>
				<th>Sub Total</th>
			</tr>
			<tr th:each="item, i : ${cart}">
				<td align="center">
					<a th:href="@{'/cart/remove/' + ${i.index}}">X</a>
				</td>
				<td th:text="${item.product.id}"></td>
				<td>
					<a th:href="@{'/product/details/' + ${item.product.id}}" 
						th:text="${item.product.name}"></a>
				</td>
				<td>
					<a th:href="@{'/product/details/' + ${item.product.id}}">
						<img th:src="@{'/assets/images/' + ${item.product.photo}}" width="120" height="100">
					</a>
				</td>
				<td th:text="${item.product.price}"></td>
				<td>
					<input type="number" min="1" name="quantities" th:value="${item.quantity}" 
						style="width: 70px;">
				</td>
				<td th:text="${item.product.price * item.quantity}"></td>
			</tr>
			<tr>
				<td colspan="6" align="right">Total</td>
				<td th:text="${total}"></td>
			</tr>
		</table>
	</form>
	
	<form method="post" th:action="${posturl}">
		
		<input type="hidden" name="upload" value="1" /> 
		<input type="hidden" name="return" th:value="${returnurl}" /> 
		<input type="hidden" name="cmd" value="_cart" /> 
		<input type="hidden" name="business" th:value="${business}" />
		
		<th:block th:each="item, i : ${cart}">
			<input type="hidden" th:name="${'item_number_' + (i.index + 1)}" 
				th:value="${item.product.id}" /> 
			<input type="hidden" th:name="${'item_name_' + (i.index + 1)}" 
				th:value="${item.product.name}" /> 
			<input type="hidden" th:name="${'amount_' + (i.index + 1)}" 
				th:value="${item.product.price}" /> 
			<input type="hidden" th:name="${'quantity_' + (i.index + 1)}" 
				th:value="${item.quantity}" /> 
		</th:block>
		
		<button type="submit">Pay</button>
		
	</form>

</body>

</html>